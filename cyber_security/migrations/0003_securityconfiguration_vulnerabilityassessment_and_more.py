# Generated by Django 5.2.7 on 2025-11-02 17:35

import django.core.validators
import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('cyber_security', '0002_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='SecurityConfiguration',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('config_name', models.CharField(max_length=200, verbose_name='اسم التكوين')),
                ('config_type', models.CharField(choices=[('FIREWALL', 'جدار الحماية'), ('ACCESS_CONTROL', 'التحكم في الوصول'), ('ENCRYPTION', 'التشفير'), ('AUTHENTICATION', 'المصادقة'), ('LOGGING', 'التسجيل'), ('MONITORING', 'المراقبة'), ('BACKUP', 'النسخ الاحتياطي'), ('NETWORK', 'الشبكة'), ('APPLICATION', 'التطبيق'), ('DATABASE', 'قاعدة البيانات')], max_length=20, verbose_name='نوع التكوين')),
                ('description', models.TextField(verbose_name='وصف التكوين')),
                ('configuration_data', models.JSONField(default=dict, verbose_name='بيانات التكوين')),
                ('default_values', models.JSONField(default=dict, verbose_name='القيم الافتراضية')),
                ('current_values', models.JSONField(default=dict, verbose_name='القيم الحالية')),
                ('compliance_standards', models.JSONField(default=list, verbose_name='معايير الامتثال')),
                ('is_compliant', models.BooleanField(default=True, verbose_name='متوافق')),
                ('compliance_notes', models.TextField(blank=True, verbose_name='ملاحظات الامتثال')),
                ('is_active', models.BooleanField(default=True, verbose_name='نشط')),
                ('is_mandatory', models.BooleanField(default=False, verbose_name='إجباري')),
                ('last_reviewed_date', models.DateTimeField(blank=True, null=True, verbose_name='تاريخ آخر مراجعة')),
                ('review_frequency', models.CharField(choices=[('WEEKLY', 'أسبوعي'), ('MONTHLY', 'شهري'), ('QUARTERLY', 'ربع سنوي'), ('ANNUALLY', 'سنوي')], default='MONTHLY', max_length=20, verbose_name='تكرار المراجعة')),
                ('change_history', models.JSONField(default=list, verbose_name='تاريخ التغييرات')),
                ('last_changed_date', models.DateTimeField(blank=True, null=True, verbose_name='تاريخ آخر تغيير')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاريخ الإنشاء')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاريخ التحديث')),
            ],
            options={
                'verbose_name': 'إعداد أمني',
                'verbose_name_plural': 'الإعدادات الأمنية',
                'ordering': ['config_type', 'config_name'],
            },
        ),
        migrations.CreateModel(
            name='VulnerabilityAssessment',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('vulnerability_id', models.CharField(max_length=50, unique=True, verbose_name='معرف الثغرة')),
                ('title', models.CharField(max_length=200, verbose_name='عنوان الثغرة')),
                ('description', models.TextField(verbose_name='وصف الثغرة')),
                ('vulnerability_type', models.CharField(choices=[('CRITICAL', 'حرج'), ('HIGH', 'عالي'), ('MEDIUM', 'متوسط'), ('LOW', 'منخفض'), ('INFO', 'معلوماتي')], max_length=10, verbose_name='نوع الثغرة')),
                ('cvss_score', models.DecimalField(blank=True, decimal_places=1, max_digits=3, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(10)], verbose_name='نقاط CVSS')),
                ('cve_id', models.CharField(blank=True, max_length=50, verbose_name='معرف CVE')),
                ('affected_system', models.CharField(max_length=200, verbose_name='النظام المتأثر')),
                ('affected_component', models.CharField(blank=True, max_length=200, verbose_name='المكون المتأثر')),
                ('affected_versions', models.JSONField(default=list, verbose_name='الإصدارات المتأثرة')),
                ('assessment_method', models.CharField(choices=[('AUTOMATED_SCAN', 'فحص آلي'), ('MANUAL_TESTING', 'اختبار يدوي'), ('PENETRATION_TEST', 'اختبار اختراق'), ('CODE_REVIEW', 'مراجعة كود'), ('CONFIGURATION_AUDIT', 'مراجعة تكوين'), ('THIRD_PARTY_REPORT', 'تقرير طرف ثالث')], max_length=25, verbose_name='طريقة التقييم')),
                ('discovery_date', models.DateTimeField(auto_now_add=True, verbose_name='تاريخ الاكتشاف')),
                ('impact_assessment', models.TextField(verbose_name='تقييم التأثير')),
                ('exploitability', models.CharField(choices=[('NONE', 'لا يمكن استغلالها'), ('DIFFICULT', 'صعب الاستغلال'), ('MODERATE', 'متوسط الاستغلال'), ('EASY', 'سهل الاستغلال')], default='MODERATE', max_length=20, verbose_name='قابلية الاستغلال')),
                ('status', models.CharField(choices=[('OPEN', 'مفتوح'), ('IN_PROGRESS', 'قيد المعالجة'), ('RESOLVED', 'مُحلول'), ('ACCEPTED', 'مقبول'), ('FALSE_POSITIVE', 'إنذار كاذب')], default='OPEN', max_length=15, verbose_name='حالة الثغرة')),
                ('remediation_steps', models.TextField(blank=True, verbose_name='خطوات المعالجة')),
                ('workaround', models.TextField(blank=True, verbose_name='الحل المؤقت')),
                ('vendor_patch_available', models.BooleanField(default=False, verbose_name='يتوفر تصحيح من المورد')),
                ('patch_details', models.JSONField(default=dict, verbose_name='تفاصيل التصحيح')),
                ('due_date', models.DateTimeField(blank=True, null=True, verbose_name='تاريخ الاستحقاق')),
                ('resolved_date', models.DateTimeField(blank=True, null=True, verbose_name='تاريخ الحل')),
                ('references', models.JSONField(default=list, verbose_name='المراجع')),
                ('external_links', models.JSONField(default=list, verbose_name='الروابط الخارجية')),
                ('notes', models.TextField(blank=True, verbose_name='ملاحظات')),
                ('false_positive_reason', models.TextField(blank=True, verbose_name='سبب الإنذار الكاذب')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاريخ الإنشاء')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاريخ التحديث')),
            ],
            options={
                'verbose_name': 'تقييم ثغرة أمنية',
                'verbose_name_plural': 'تقييمات الثغرات الأمنية',
                'ordering': ['-vulnerability_type', '-discovery_date'],
            },
        ),
        migrations.AlterModelOptions(
            name='securityauditlog',
            options={'ordering': ['-timestamp'], 'verbose_name': 'سجل مراجعة أمني', 'verbose_name_plural': 'سجلات المراجعة الأمنية'},
        ),
        migrations.RemoveIndex(
            model_name='securityauditlog',
            name='cyber_secur_event_t_51089c_idx',
        ),
        migrations.RemoveIndex(
            model_name='securityauditlog',
            name='cyber_secur_user_id_e9ab90_idx',
        ),
        migrations.RemoveIndex(
            model_name='securityauditlog',
            name='cyber_secur_was_suc_15df92_idx',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='affected_objects',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='automated_analysis',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='content_type',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='error_message',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='event_description',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='event_id',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='event_type',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='object_id',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='request_data',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='request_method',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='request_path',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='response_code',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='severity',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='threat_indicators',
        ),
        migrations.RemoveField(
            model_name='securityauditlog',
            name='was_successful',
        ),
        migrations.AddField(
            model_name='securityauditlog',
            name='action_description',
            field=models.TextField(default='', verbose_name='وصف العملية'),
        ),
        migrations.AddField(
            model_name='securityauditlog',
            name='action_type',
            field=models.CharField(choices=[('LOGIN', 'تسجيل دخول'), ('LOGOUT', 'تسجيل خروج'), ('PASSWORD_CHANGE', 'تغيير كلمة مرور'), ('PROFILE_UPDATE', 'تحديث الملف الشخصي'), ('DATA_ACCESS', 'الوصول للبيانات'), ('DATA_EXPORT', 'تصدير بيانات'), ('DATA_DELETE', 'حذف بيانات'), ('PERMISSION_CHANGE', 'تغيير صلاحية'), ('SYSTEM_CONFIG', 'تكوين النظام'), ('FILE_UPLOAD', 'رفع ملف'), ('FILE_DOWNLOAD', 'تحميل ملف'), ('API_ACCESS', 'الوصول لواجهة برمجية'), ('SUSPICIOUS_ACTIVITY', 'نشاط مشبوه')], default='DATA_ACCESS', max_length=20, verbose_name='نوع العملية'),
        ),
        migrations.AddField(
            model_name='securityauditlog',
            name='geolocation',
            field=models.JSONField(default=dict, verbose_name='الموقع الجغرافي'),
        ),
        migrations.AddField(
            model_name='securityauditlog',
            name='resource_accessed',
            field=models.CharField(blank=True, max_length=200, verbose_name='المورد المُستخدَم'),
        ),
        migrations.AddField(
            model_name='securityauditlog',
            name='result',
            field=models.CharField(choices=[('SUCCESS', 'نجح'), ('FAILED', 'فشل'), ('BLOCKED', 'مُحظور'), ('WARNING', 'تحذير')], default='SUCCESS', max_length=10, verbose_name='نتيجة العملية'),
        ),
        migrations.AlterField(
            model_name='securityauditlog',
            name='ip_address',
            field=models.GenericIPAddressField(blank=True, null=True, verbose_name='عنوان IP'),
        ),
        migrations.AlterField(
            model_name='securityauditlog',
            name='risk_score',
            field=models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='نقاط المخاطر'),
        ),
        migrations.AlterField(
            model_name='securityauditlog',
            name='user',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to=settings.AUTH_USER_MODEL, verbose_name='المستخدم'),
        ),
        migrations.AddIndex(
            model_name='securityauditlog',
            index=models.Index(fields=['user', 'timestamp'], name='cyber_secur_user_id_93b8f0_idx'),
        ),
        migrations.AddIndex(
            model_name='securityauditlog',
            index=models.Index(fields=['action_type', 'result'], name='cyber_secur_action__8bfdc6_idx'),
        ),
        migrations.AddField(
            model_name='securityconfiguration',
            name='last_changed_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='changed_security_configs', to=settings.AUTH_USER_MODEL, verbose_name='آخر من غيّر'),
        ),
        migrations.AddField(
            model_name='securityconfiguration',
            name='last_reviewed_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_security_configs', to=settings.AUTH_USER_MODEL, verbose_name='آخر مراجع'),
        ),
        migrations.AddField(
            model_name='securityconfiguration',
            name='owner',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='owned_security_configs', to=settings.AUTH_USER_MODEL, verbose_name='المسؤول'),
        ),
        migrations.AddField(
            model_name='vulnerabilityassessment',
            name='assigned_to',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_vulnerabilities', to=settings.AUTH_USER_MODEL, verbose_name='مُعيّن إلى'),
        ),
        migrations.AddField(
            model_name='vulnerabilityassessment',
            name='discovered_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='discovered_vulnerabilities', to=settings.AUTH_USER_MODEL, verbose_name='اكتُشِف بواسطة'),
        ),
        migrations.AddIndex(
            model_name='securityconfiguration',
            index=models.Index(fields=['config_type', 'is_active'], name='cyber_secur_config__33dfe9_idx'),
        ),
        migrations.AddIndex(
            model_name='securityconfiguration',
            index=models.Index(fields=['is_compliant'], name='cyber_secur_is_comp_332292_idx'),
        ),
        migrations.AddIndex(
            model_name='securityconfiguration',
            index=models.Index(fields=['owner'], name='cyber_secur_owner_i_3d8b15_idx'),
        ),
        migrations.AddIndex(
            model_name='securityconfiguration',
            index=models.Index(fields=['last_reviewed_date'], name='cyber_secur_last_re_fad7b9_idx'),
        ),
        migrations.AddIndex(
            model_name='vulnerabilityassessment',
            index=models.Index(fields=['vulnerability_type', 'status'], name='cyber_secur_vulnera_7e8161_idx'),
        ),
        migrations.AddIndex(
            model_name='vulnerabilityassessment',
            index=models.Index(fields=['affected_system'], name='cyber_secur_affecte_cae069_idx'),
        ),
        migrations.AddIndex(
            model_name='vulnerabilityassessment',
            index=models.Index(fields=['assigned_to'], name='cyber_secur_assigne_ad3bb9_idx'),
        ),
        migrations.AddIndex(
            model_name='vulnerabilityassessment',
            index=models.Index(fields=['due_date'], name='cyber_secur_due_dat_c0e4f0_idx'),
        ),
        migrations.AddIndex(
            model_name='vulnerabilityassessment',
            index=models.Index(fields=['cvss_score'], name='cyber_secur_cvss_sc_1918f4_idx'),
        ),
    ]
